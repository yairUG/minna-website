// =============================================
//  MINNA — Legal Recruitment & Career Advisory
// =============================================

// ── TRANSLATIONS ──────────────────────────────
const translations = {
  en: {
    'nav.logo':      'Minna Felig',
    'nav.about':     'About',
    'nav.companies': 'Companies',
    'nav.lawyers':   'Lawyers',
    'nav.experience':'Experience',
    'nav.contact':   'Contact',

    'hero.headline':      'Minna Felig Legal Services Consulting',
    'hero.sub':           'For over 25 years, I have advised international companies, high-tech legal departments, and lawyers on building strong legal teams and navigating career transitions.',
    'hero.cta':           'Schedule a Confidential Consultation',
    'hero.btn.companies': 'For Companies',
    'hero.btn.lawyers':   'For Lawyers',

    'about.label':   'About',
    'about.heading': 'About',
    'about.p1': 'For more than 25 years, I have worked exclusively in the Israeli legal market.',
    'about.p2': 'As the founder of Israel\'s first legal recruitment business, I have advised hundreds of companies and legal professionals on strategic growth and career decisions.',
    'about.p3': 'My background includes legal training and experience in New York — giving me both international perspective and deep local knowledge. I work personally with each client, with discretion and a practical approach.',

    'companies.label':   'For Companies',
    'companies.heading': 'For Companies',
    'companies.intro':   'I advise international and high-tech companies operating in Israel on building and strengthening their legal teams.',
    'companies.s1':      'Legal Recruitment at All Levels',
    'companies.s2':      'General Counsel and Senior In-House Placements',
    'companies.s3':      'Strategic Legal Team Building',
    'companies.s4':      'Market Intelligence and Advisory',
    'companies.closing': 'My focus is not volume. It is precision.',
    'companies.photo':   'Office photo coming soon',

    'lawyers.label':   'For Lawyers',
    'lawyers.heading': 'For Lawyers',
    'lawyers.intro':   'I work with mid-level lawyers seeking clarity, direction, and meaningful career progression.',
    'lawyers.s1':      'Confidential Career Transitions',
    'lawyers.s2':      'Strategic Career Positioning',
    'lawyers.s3':      'Resume Optimization for Modern Recruitment Systems',
    'lawyers.s4':      'Navigating AI-Driven Screening Processes',
    'lawyers.para':    'Today\'s hiring landscape is increasingly automated. I help lawyers position themselves effectively while staying true to their long-term goals.',

    'exp.label':            'Experience',
    'exp.heading':          'Experience',
    'exp.years.label':      'years in the Israeli legal market',
    'exp.placements.label': 'legal placements',
    'exp.detail1':          'Experience advising on law firm mergers and practice integrations.',
    'exp.detail2':          'Specialization in international and high-tech companies.',
    'exp.engagements':      'Selected Engagements',
    'exp.e1':               'Facilitated a merger between a mid-sized banking firm and a major firm',
    'exp.e2':               'Integrated a niche legal practice into a leading law firm',
    'exp.e3':               'Placed professionals into international corporations and major Israeli firms',
    'exp.photo':            'Photo coming soon',

    'test.label':   'Testimonials',
    'test.heading': 'What Clients Say',

    'phil.label':   'My Approach',
    'phil.heading': 'My Approach',
    'phil.p1': 'I believe recruitment is not a transaction. It is a strategic decision that affects organizations and lives.',
    'phil.p2': 'I work personally with every client. I am candid about expectations and realistic about outcomes.',
    'phil.p3': 'Discretion is fundamental. Integrity is non-negotiable.',

    'contact.label':         'Contact',
    'contact.heading':       'Confidential Inquiry',
    'contact.intro':         'All inquiries are handled personally and with complete discretion.',
    'contact.email.label':   'Email',
    'contact.phone.label':   'Phone',
    'contact.form.name':     'Name',
    'contact.form.company':  'Company',
    'contact.form.optional': '(optional)',
    'contact.form.email':    'Email',
    'contact.form.phone':    'Phone',
    'contact.form.message':  'Message',
    'contact.submit':        'Send Inquiry',
    'contact.ph.name':       'Your full name',
    'contact.ph.company':    'Your company or firm',
    'contact.ph.email':      'your@email.com',
    'contact.ph.phone':      '+972',
    'contact.ph.message':    'How can I help you?',

    'footer.tagline': 'Minna Felig Legal Services Consulting · Israel',
  },

  he: {
    'nav.logo':      'מינה פליג',
    'nav.about':     'אודות',
    'nav.companies': 'לחברות',
    'nav.lawyers':   'לעורכי דין',
    'nav.experience':'ניסיון',
    'nav.contact':   'צור קשר',

    'hero.headline':      'גיוס משפטי אסטרטגי<br />וייעוץ קריירה בישראל',
    'hero.sub':           'במשך יותר מ-25 שנה, ייעצתי לחברות בינלאומיות, מחלקות משפטיות בהייטק, ועורכי דין על בניית צוותים משפטיים חזקים וניווט במעברי קריירה.',
    'hero.cta':           'קבע ייעוץ חסוי',
    'hero.btn.companies': 'לחברות',
    'hero.btn.lawyers':   'לעורכי דין',

    'about.label':   'אודות',
    'about.heading': 'אודות',
    'about.p1': 'במשך יותר מ-25 שנה, עבדתי באופן בלעדי בשוק המשפטי הישראלי.',
    'about.p2': 'כמייסדת עסק הגיוס המשפטי הראשון בישראל, ייעצתי למאות חברות ואנשי מקצוע משפטיים על צמיחה אסטרטגית והחלטות קריירה.',
    'about.p3': 'הרקע שלי כולל הכשרה משפטית וניסיון בניו יורק — מה שמאפשר לי להביא גם פרספקטיבה בינלאומית וגם ידע מקומי עמוק. אני עובדת באופן אישי עם כל לקוח, בשיקול דעת ובגישה פרקטית.',

    'companies.label':   'לחברות',
    'companies.heading': 'לחברות',
    'companies.intro':   'אני מייעצת לחברות בינלאומיות וחברות הייטק הפועלות בישראל על בניית וחיזוק הצוותים המשפטיים שלהן.',
    'companies.s1':      'גיוס משפטי בכיר',
    'companies.s2':      'מיקומי יועץ משפטי ראשי ובכיר בחברות',
    'companies.s3':      'בניית צוות משפטי אסטרטגי',
    'companies.s4':      'מודיעין שוק וייעוץ',
    'companies.closing': 'המיקוד שלי אינו כמות. זוהי דיוק.',
    'companies.photo':   'תמונת משרד בקרוב',

    'lawyers.label':   'לעורכי דין',
    'lawyers.heading': 'לעורכי דין',
    'lawyers.intro':   'אני עובדת עם עורכי דין ברמה בינונית המחפשים בהירות, כיוון והתקדמות קריירה משמעותית.',
    'lawyers.s1':      'מעברי קריירה חסויים',
    'lawyers.s2':      'מיצוב קריירה אסטרטגי',
    'lawyers.s3':      'אופטימיזציה של קורות חיים למערכות גיוס מודרניות',
    'lawyers.s4':      'ניווט בתהליכי סינון מבוססי בינה מלאכותית',
    'lawyers.para':    'נוף הגיוס של היום הופך לאוטומטי יותר ויותר. אני עוזרת לעורכי דין למצב את עצמם ביעילות תוך שמירה על מטרות קריירה לטווח ארוך.',

    'exp.label':            'ניסיון',
    'exp.heading':          'ניסיון',
    'exp.years.label':      'שנות ניסיון בשוק המשפטי הישראלי',
    'exp.placements.label': 'מיקומים משפטיים',
    'exp.detail1':          'ניסיון בייעוץ על מיזוגי משרדי עורכי דין ואינטגרציות פרקטיקה.',
    'exp.detail2':          'התמחות בחברות בינלאומיות וחברות הייטק.',
    'exp.engagements':      'מעורבויות נבחרות',
    'exp.e1':               'הובלת מיזוג בין משרד בנקאות בינוני לבין משרד מוביל',
    'exp.e2':               'שילוב פרקטיקה משפטית ייחודית לתוך משרד עורכי דין מוביל',
    'exp.e3':               'מיקום אנשי מקצוע בתאגידים בינלאומיים ובמשרדים ישראליים מובילים',
    'exp.photo':            'תמונה בקרוב',

    'test.label':   'המלצות',
    'test.heading': 'מה אומרים הלקוחות',

    'phil.label':   'הגישה שלי',
    'phil.heading': 'הגישה שלי',
    'phil.p1': 'אני מאמינה שגיוס אינו עסקה. זוהי החלטה אסטרטגית המשפיעה על ארגונים וחיים.',
    'phil.p2': 'אני עובדת באופן אישי עם כל לקוח. אני כנה לגבי ציפיות וריאליסטית לגבי תוצאות.',
    'phil.p3': 'שיקול דעת הוא יסוד. יושרה אינה ניתנת לפשרה.',

    'contact.label':         'צור קשר',
    'contact.heading':       'פנייה חסויה',
    'contact.intro':         'כל הפניות מטופלות באופן אישי ובשיקול דעת מלא.',
    'contact.email.label':   'אימייל',
    'contact.phone.label':   'טלפון',
    'contact.form.name':     'שם',
    'contact.form.company':  'חברה',
    'contact.form.optional': '(אופציונלי)',
    'contact.form.email':    'אימייל',
    'contact.form.phone':    'טלפון',
    'contact.form.message':  'הודעה',
    'contact.submit':        'שלח פנייה',
    'contact.ph.name':       'שמך המלא',
    'contact.ph.company':    'החברה או המשרד שלך',
    'contact.ph.email':      'your@email.com',
    'contact.ph.phone':      '+972',
    'contact.ph.message':    'איך אוכל לעזור לך?',

    'footer.tagline': 'מינה פליג ייעוץ שירותים משפטיים · ישראל',
  }
};

// ── APPLY LANGUAGE ────────────────────────────
function applyLanguage(lang) {
  const t = translations[lang];
  if (!t) return;

  // Update HTML root attributes
  document.documentElement.lang = lang;
  document.documentElement.dir  = lang === 'he' ? 'rtl' : 'ltr';

  // Update page title
  document.title = lang === 'he'
    ? 'מינה פליג — גיוס משפטי וייעוץ קריירה'
    : 'Minna Felig — Legal Recruitment & Career Advisory';

  // Text content
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.dataset.i18n;
    if (t[key] !== undefined) el.textContent = t[key];
  });

  // innerHTML — for elements containing HTML tags (e.g. <br>)
  document.querySelectorAll('[data-i18n-html]').forEach(el => {
    const key = el.dataset.i18nHtml;
    if (t[key] !== undefined) el.innerHTML = t[key];
  });

  // Placeholders
  document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
    const key = el.dataset.i18nPlaceholder;
    if (t[key] !== undefined) el.placeholder = t[key];
  });

  // Update toggle button active state
  document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.classList.toggle('active', btn.dataset.lang === lang);
  });

  // Persist preference
  localStorage.setItem('lang', lang);
}

document.addEventListener('DOMContentLoaded', () => {

  // ── YEAR ──────────────────────────────────
  const yearEl = document.getElementById('year');
  if (yearEl) yearEl.textContent = new Date().getFullYear();

  // ── LANGUAGE TOGGLE ───────────────────────
  const savedLang = localStorage.getItem('lang') || 'en';
  applyLanguage(savedLang);

  document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.addEventListener('click', () => applyLanguage(btn.dataset.lang));
  });

  // ── NAV SCROLL STATE ──────────────────────
  const navbar = document.getElementById('navbar');
  const onScroll = () => {
    navbar.classList.toggle('scrolled', window.scrollY > 40);
  };
  window.addEventListener('scroll', onScroll, { passive: true });

  // ── MOBILE NAV TOGGLE ─────────────────────
  const toggle = document.querySelector('.nav-toggle');
  const navLinks = document.querySelector('.nav-links');

  toggle.addEventListener('click', () => {
    navLinks.classList.toggle('open');
  });

  // Close on nav link click
  navLinks.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => navLinks.classList.remove('open'));
  });

  // ── SCROLL REVEAL ─────────────────────────
  const revealEls = document.querySelectorAll('.reveal');

  const revealObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
        revealObserver.unobserve(entry.target);
      }
    });
  }, { threshold: 0.12, rootMargin: '0px 0px -40px 0px' });

  revealEls.forEach(el => revealObserver.observe(el));

  // ── SERVICE ITEMS (staggered) ─────────────
  const serviceObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const siblings = entry.target.closest('ul').querySelectorAll('.service-item');
        siblings.forEach((item, i) => {
          setTimeout(() => item.classList.add('visible'), i * 120);
        });
        serviceObserver.unobserve(entry.target);
      }
    });
  }, { threshold: 0.2 });

  // Observe only the first item in each list
  document.querySelectorAll('.service-list').forEach(list => {
    const first = list.querySelector('.service-item');
    if (first) serviceObserver.observe(first);
  });

  // ── NUMBER COUNTER ────────────────────────
  const statNumbers = document.querySelectorAll('.stat-number[data-target]');

  const countUp = (el) => {
    const target = parseInt(el.dataset.target, 10);
    const duration = 1400;
    const start = performance.now();

    const step = (now) => {
      const elapsed = now - start;
      const progress = Math.min(elapsed / duration, 1);
      // Ease out cubic
      const eased = 1 - Math.pow(1 - progress, 3);
      el.textContent = Math.floor(eased * target);
      if (progress < 1) requestAnimationFrame(step);
      else el.textContent = target;
    };

    requestAnimationFrame(step);
  };

  const counterObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        countUp(entry.target);
        counterObserver.unobserve(entry.target);
      }
    });
  }, { threshold: 0.5 });

  statNumbers.forEach(el => counterObserver.observe(el));

  // ── ACTIVE NAV LINK ───────────────────────
  const sections = document.querySelectorAll('section[id]');
  const navItems = document.querySelectorAll('.nav-links a');

  const activeObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const id = entry.target.getAttribute('id');
        navItems.forEach(link => {
          link.classList.toggle(
            'active',
            link.getAttribute('href') === `#${id}`
          );
        });
      }
    });
  }, { threshold: 0.4 });

  sections.forEach(s => activeObserver.observe(s));

  // ── CONTACT FORM (basic mailto fallback) ──
  const form = document.getElementById('contactForm');
  if (form) {
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const name    = form.querySelector('#name').value;
      const company = form.querySelector('#company').value;
      const email   = form.querySelector('#email').value;
      const phone   = form.querySelector('#phone').value;
      const message = form.querySelector('#message').value;

      const body = [
        `Name: ${name}`,
        company ? `Company: ${company}` : '',
        `Email: ${email}`,
        phone ? `Phone: ${phone}` : '',
        `\n${message}`
      ].filter(Boolean).join('\n');

      window.location.href = `mailto:minnafelig@gmail.com?subject=Confidential Inquiry from ${encodeURIComponent(name)}&body=${encodeURIComponent(body)}`;
    });
  }

});
